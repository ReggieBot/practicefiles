This might be some of the ugliest code i've ever written.
This sucks.
